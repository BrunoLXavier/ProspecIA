{"openapi":"3.1.0","info":{"title":"ProspecIA","description":"Intelligent Research Prospecting and Management System with Responsible AI","version":"1.0.0"},"paths":{"/health":{"get":{"tags":["Health"],"summary":"Basic health check","description":"Returns basic application health status","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/health/ready":{"get":{"tags":["Health"],"summary":"Readiness check","description":"Checks if application is ready to serve requests (all dependencies available)","operationId":"readiness_check_health_ready_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DetailedHealthResponse"}}}}}}},"/health/live":{"get":{"tags":["Health"],"summary":"Liveness check","description":"Checks if application is alive (process running)","operationId":"liveness_check_health_live_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/system/info":{"get":{"tags":["System"],"summary":"System information","description":"Returns system configuration and environment information","operationId":"get_system_info_system_info_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SystemInfoResponse"}}}}}}},"/system/features":{"get":{"tags":["System"],"summary":"Feature flags","description":"Returns current feature flag configuration","operationId":"get_feature_flags_system_features_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FeatureFlagsResponse"}}}}}}},"/system/metrics":{"get":{"tags":["System"],"summary":"Prometheus metrics","description":"Returns Prometheus-compatible metrics for scraping","operationId":"get_metrics_system_metrics_get","responses":{"200":{"description":"Successful Response","content":{"text/plain":{"schema":{"type":"string"}}}}}}},"/ingestions":{"post":{"tags":["Ingestion"],"summary":"Create Ingestion","description":"Create new data ingestion with file upload.\n\n- Validates file size (â¤100MB)\n- Uploads file to MinIO\n- Processes with LGPD agent\n- Creates lineage node in Neo4j\n- Generates QR code for tracking","operationId":"create_ingestao_ingestions_post","parameters":[{"name":"fonte","in":"query","required":true,"schema":{"allOf":[{"$ref":"#/components/schemas/FonteIngestao"}],"description":"Data source","title":"Fonte"},"description":"Data source"},{"name":"metodo","in":"query","required":true,"schema":{"allOf":[{"$ref":"#/components/schemas/MetodoIngestao"}],"description":"Ingestion method","title":"Metodo"},"description":"Ingestion method"},{"name":"consentimento_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"description":"LGPD consent UUID","title":"Consentimento Id"},"description":"LGPD consent UUID"},{"name":"descricao","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Description","title":"Descricao"},"description":"Description"}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_create_ingestao_ingestions_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IngestionCreateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Ingestion"],"summary":"List Ingestions","description":"List ingestions with filters and pagination.\n\nApplies RLS filtering by tenant_id.","operationId":"list_ingestoes_ingestions_get","parameters":[{"name":"fonte","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/FonteIngestao"},{"type":"null"}],"description":"Filter by source","title":"Fonte"},"description":"Filter by source"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/StatusIngestao"},{"type":"null"}],"description":"Filter by status","title":"Status"},"description":"Filter by status"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Pagination offset","default":0,"title":"Offset"},"description":"Pagination offset"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Pagination limit","default":50,"title":"Limit"},"description":"Pagination limit"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IngestionListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ingestions/{id}":{"get":{"tags":["Ingestion"],"summary":"Get Ingestion","description":"Get ingestion details by ID with data sample.","operationId":"get_ingestao_ingestions__id__get","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IngestionDetailResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ingestions/{id}/lineage":{"get":{"tags":["Ingestion"],"summary":"Get Lineage","description":"Get data lineage graph for ingestion.\n\nReturns nodes and edges for visualization.","operationId":"get_linhagem_ingestions__id__lineage_get","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Id"}},{"name":"max_depth","in":"query","required":false,"schema":{"type":"integer","maximum":10,"minimum":1,"description":"Maximum graph depth","default":5,"title":"Max Depth"},"description":"Maximum graph depth"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LineageResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ingestions/{id}/lgpd-report":{"get":{"tags":["Ingestion"],"summary":"Get LGPD Report","description":"Get LGPD compliance report for ingestion.\n\nReturns PII detection results, consent status, compliance score.","operationId":"get_lgpd_report_ingestions__id__lgpd_report_get","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LGPDReportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ingestions/{id}/download":{"get":{"tags":["Ingestion"],"summary":"Get Presigned Download URL","description":"Return a presigned URL (private access) to download the stored file.\nDefault expiry: 60 minutes.","operationId":"get_presigned_download_url_ingestions__id__download_get","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Id"}},{"name":"expiry_minutes","in":"query","required":false,"schema":{"type":"integer","maximum":240,"minimum":1,"description":"URL expiry in minutes","default":60,"title":"Expiry Minutes"},"description":"URL expiry in minutes"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ingestions/{id}/pii":{"get":{"tags":["Ingestion"],"summary":"Get PII Details","description":"Get detailed PII data detected in ingestion.\nReturns masked samples for privacy.","operationId":"get_pii_details_ingestions__id__pii_get","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/consents/{id}":{"get":{"tags":["Consent"],"summary":"Get Consent","description":"Get consent details by ID.","operationId":"get_consentimento_consents__id__get","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"tags":["Root"],"summary":"Root","description":"Root endpoint providing API information.\n\nReturns:\n    dict: API metadata","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Body_create_ingestao_ingestions_post":{"properties":{"file":{"type":"string","format":"binary","title":"File","description":"File to ingest"}},"type":"object","required":["file"],"title":"Body_create_ingestao_ingestions_post"},"ConsentRecord":{"properties":{"tipo_consentimento":{"type":"string","title":"Consent Type","description":"Consent type"},"finalidade":{"type":"string","title":"Purpose","description":"Purpose"},"status":{"type":"string","title":"Status","description":"Status"},"data_consentimento":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Consent Date","description":"Grant date"},"data_revogacao":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Revocation Date","description":"Revocation date"}},"type":"object","required":["tipo_consentimento","finalidade","status"],"title":"ConsentRecord","description":"Consent record details."},"DetailedHealthResponse":{"properties":{"status":{"type":"string","title":"Status"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp"},"version":{"type":"string","title":"Version"},"environment":{"type":"string","title":"Environment"},"services":{"additionalProperties":{"type":"object"},"type":"object","title":"Services"}},"type":"object","required":["status","timestamp","version","environment","services"],"title":"DetailedHealthResponse","description":"Detailed health check response with service statuses."},"FeatureFlagsResponse":{"properties":{"features":{"additionalProperties":{"type":"boolean"},"type":"object","title":"Features"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp"}},"type":"object","required":["features","timestamp"],"title":"FeatureFlagsResponse","description":"Feature flags response model."},"FonteIngestao":{"type":"string","enum":["rais","ibge","inpi","finep","bndes","customizada"],"title":"FonteIngestao","description":"Data source enum for ingestion."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp"},"version":{"type":"string","title":"Version"},"environment":{"type":"string","title":"Environment"}},"type":"object","required":["status","timestamp","version","environment"],"title":"HealthResponse","description":"Health check response model."},"IngestionCreateResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id","description":"Ingestion UUID"},"fonte":{"type":"string","title":"Source","description":"Data source"},"status":{"type":"string","title":"Status","description":"Current status"},"arquivo_storage_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Storage Path","description":"MinIO storage path"},"qr_code_base64":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"QR Code Base64","description":"QR code for tracking"},"confiabilidade_score":{"type":"integer","title":"Reliability Score","description":"Reliability score 0-100"},"data_ingestao":{"type":"string","format":"date-time","title":"Ingestion Time","description":"Ingestion timestamp"}},"type":"object","required":["id","fonte","status","confiabilidade_score","data_ingestao"],"title":"IngestionCreateResponse","description":"Response schema for created ingestion."},"IngestionDetailResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"fonte":{"type":"string","title":"Source"},"metodo":{"type":"string","title":"Method"},"arquivo_original":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Original File"},"arquivo_storage_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Storage Path"},"arquivo_size_bytes":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"File Size Bytes"},"arquivo_mime_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"File MIME Type"},"confiabilidade_score":{"type":"integer","title":"Reliability Score"},"total_registros":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Total Records"},"registros_validos":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Valid Records"},"registros_invalidos":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Invalid Records"},"status":{"type":"string","title":"Status"},"erros_encontrados":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Errors Found"},"pii_detectado":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"PII Detected"},"acoes_lgpd":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"LGPD Actions"},"consentimento_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Consent Id"},"criado_por":{"type":"string","format":"uuid","title":"Created By"},"tenant_id":{"type":"string","title":"Tenant Id"},"data_ingestao":{"type":"string","format":"date-time","title":"Ingestion Time"},"data_processamento":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Processing Time"},"data_criacao":{"type":"string","format":"date-time","title":"Created At"},"data_atualizacao":{"type":"string","format":"date-time","title":"Updated At"},"descricao":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"},"metadata_adicional":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Additional Metadata"},"dados_brutos_sample":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Raw Data Sample","description":"Sample of raw data"}},"type":"object","required":["id","fonte","metodo","confiabilidade_score","status","criado_por","tenant_id","data_ingestao","data_criacao","data_atualizacao"],"title":"IngestionDetailResponse","description":"Detailed ingestion response."},"IngestionListItem":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"fonte":{"type":"string","title":"Source"},"status":{"type":"string","title":"Status"},"confiabilidade_score":{"type":"integer","title":"Reliability Score"},"total_registros":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Total Records"},"data_ingestao":{"type":"string","format":"date-time","title":"Ingestion Time"},"criado_por":{"type":"string","format":"uuid","title":"Created By"},"consentimento_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Consent Id"}},"type":"object","required":["id","fonte","status","confiabilidade_score","data_ingestao","criado_por"],"title":"IngestionListItem","description":"Simplified ingestion item for list view."},"IngestionListResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/IngestionListItem"},"type":"array","title":"Items","description":"Ingestion items"},"total":{"type":"integer","title":"Total","description":"Total count"},"offset":{"type":"integer","title":"Offset","description":"Offset"},"limit":{"type":"integer","title":"Limit","description":"Limit"}},"type":"object","required":["items","total","offset","limit"],"title":"IngestionListResponse","description":"Paginated list response."},"LGPDReportResponse":{"properties":{"ingestao_id":{"type":"string","format":"uuid","title":"Ingestion Id","description":"Ingestion UUID"},"pii_types_detected":{"additionalProperties":{"type":"integer"},"type":"object","title":"PII Types Detected","description":"PII counts by type"},"pii_details":{"items":{"$ref":"#/components/schemas/PIITypeStat"},"type":"array","title":"PII Details","description":"Detailed PII statistics"},"total_pii_instances":{"type":"integer","title":"Total PII Instances","description":"Total number of PII instances"},"masking_actions":{"items":{"type":"string"},"type":"array","title":"Masking Actions","description":"Actions taken"},"consent_status":{"type":"string","title":"Consent Status","description":"Consent validation status"},"consent_records":{"items":{"$ref":"#/components/schemas/ConsentRecord"},"type":"array","title":"Consent Records","description":"Consent details"},"consentimento_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Consent Id","description":"Consent UUID"},"compliance_score":{"type":"integer","title":"Compliance Score","description":"Compliance score 0-100"},"risk_level":{"type":"string","title":"Risk Level","description":"Risk level: LOW, MEDIUM, HIGH, CRITICAL"},"recommendations":{"items":{"type":"string"},"type":"array","title":"Recommendations","description":"Compliance recommendations"},"lgpd_articles_applicable":{"items":{"type":"string"},"type":"array","title":"LGPD Articles Applicable","description":"Applicable LGPD articles"},"data_analysis":{"type":"string","title":"Data Analysis","description":"Detailed analysis text"},"data_processamento":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Processing Time","description":"Processing timestamp"}},"type":"object","required":["ingestao_id","pii_types_detected","total_pii_instances","masking_actions","consent_status","compliance_score","risk_level","recommendations","data_analysis"],"title":"LGPDReportResponse","description":"LGPD compliance report."},"LineageEdge":{"properties":{"source":{"type":"string","title":"Source","description":"Source node UUID"},"target":{"type":"string","title":"Target","description":"Target node UUID"},"type":{"type":"string","title":"Type","description":"Relationship type"},"properties":{"type":"object","title":"Properties","description":"Edge properties"}},"type":"object","required":["source","target","type"],"title":"LineageEdge","description":"Lineage graph edge."},"LineageNode":{"properties":{"id":{"type":"string","title":"Id","description":"Node UUID"},"type":{"type":"string","title":"Type","description":"Node type (ingestion, transformation, dataset)"},"label":{"type":"string","title":"Label","description":"Node label"},"properties":{"type":"object","title":"Properties","description":"Node properties"}},"type":"object","required":["id","type","label"],"title":"LineageNode","description":"Lineage graph node."},"LineageResponse":{"properties":{"ingestao_id":{"type":"string","format":"uuid","title":"Ingestion Id","description":"Root ingestion UUID"},"nodes":{"items":{"$ref":"#/components/schemas/LineageNode"},"type":"array","title":"Nodes","description":"Graph nodes"},"edges":{"items":{"$ref":"#/components/schemas/LineageEdge"},"type":"array","title":"Edges","description":"Graph edges"},"dados_brutos_sample":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Raw Data Sample","description":"First 100 rows"},"transformacoes":{"items":{"type":"string"},"type":"array","title":"Transformations","description":"Transformation steps"},"confiabilidade_score":{"type":"integer","title":"Reliability Score","description":"Reliability score"},"data_ingestao":{"type":"string","format":"date-time","title":"Ingestion Time","description":"Ingestion timestamp"}},"type":"object","required":["ingestao_id","nodes","edges","transformacoes","confiabilidade_score","data_ingestao"],"title":"LineageResponse","description":"Data lineage response."},"MetodoIngestao":{"type":"string","enum":["batch_upload","api_pull","manual","scheduled"],"title":"MetodoIngestao","description":"Method enum for data ingestion."},"PIITypeStat":{"properties":{"type":{"type":"string","title":"Type","description":"PII type name"},"count":{"type":"integer","title":"Count","description":"Number of instances"},"samples":{"items":{"type":"string"},"type":"array","title":"Samples","description":"Sample values (masked)"},"detected":{"type":"boolean","title":"Detected","description":"Whether this PII type was detected"}},"type":"object","required":["type","count","detected"],"title":"PIITypeStat","description":"PII type statistics."},"StatusIngestao":{"type":"string","enum":["pendente","processando","concluida","falha","cancelada"],"title":"StatusIngestao","description":"Status enum for ingestion records."},"SystemInfoResponse":{"properties":{"application":{"type":"object","title":"Application"},"environment":{"type":"object","title":"Environment"},"features":{"additionalProperties":{"type":"boolean"},"type":"object","title":"Features"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp"}},"type":"object","required":["application","environment","features","timestamp"],"title":"SystemInfoResponse","description":"System information response model."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}
